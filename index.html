<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <title>Undangan Pernikahan Fauzi & Liansky</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <!-- Firebase SDK -->
  <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-database-compat.js"></script>
  <style>
    /* Body and Background */
    body {
      font-family: 'Segoe UI', sans-serif;
      margin: 0;
      padding: 0;
      color: #333;
      background: #fff;
    }

    /* Page Backgrounds */
    .background-1, .background-2, .background-3 {
      background-size: cover;
      background-position: top center;
      background-repeat: no-repeat;
      padding-top: 24px;
      padding-bottom: 24px;
    }
    .background-1 { background-image: url('background-1.jpg'); }
    .background-2 { background-image: url('background-2.jpg'); margin-top: 24px; }
    .background-3 { background-image: url('background-3.jpg'); margin-top: 24px; }

    /* Container */
    .container {
      max-width: 700px;
      margin: auto;
      padding: 24px;
      background: rgba(255, 255, 255, 0.6);
      border-radius: 16px;
    }

    /* Headings */
    h1, h2, h3 { text-align: center; margin-bottom: 8px; }

    /* Dynamic Title */
    .dynamic-title {
      font-size: 32px;
      display: flex;
      justify-content: center;
      align-items: center;
      gap: 8px;
      flex-wrap: wrap;
    }
    .dynamic-title span { font-weight: 600; }
    .dynamic-title .amp { font-size: 52px; }

    /* Countdown */
    .countdown { font-size: 20px; text-align: center; margin: 16px 0; font-weight: bold; }

    /* Buttons */
    .button, button[type="submit"] {
      display: block;
      margin: 12px auto;
      padding: 14px 24px;
      background: #444;
      color: white;
      border-radius: 8px;
      text-decoration: none;
      font-size: 16px;
      border: none;
      cursor: pointer;
    }

    /* Form Inputs */
    input, textarea, select {
      display: block;
      width: 90%;
      max-width: 500px;
      margin: 8px auto;
      padding: 10px;
      border-radius: 6px;
      border: 1px solid #ccc;
    }

    /* Music Toggle */
    #music-toggle {
      position: fixed;
      bottom: 20px;
      right: 20px;
      z-index: 1000;
      background: rgba(255,255,255,0.7);
      border: none;
      border-radius: 50%;
      width: 40px;
      height: 40px;
      font-size: 18px;
      cursor: pointer;
    }

    /* Pagination */
    #pagination button {
      margin: 4px;
      padding: 6px 12px;
      border-radius: 6px;
      border: 1px solid #ccc;
      cursor: pointer;
    }

    /* Entry display */
    .entry {
      background: #f7f7f7;
      padding: 12px;
      margin: 8px auto;
      border-radius: 8px;
      width: 90%;
      max-width: 600px;
    }
  </style>
</head>
<body>
  <audio id="bg-music" autoplay loop>
    <source src="musik-latar.mp3" type="audio/mpeg">
  </audio>
  <button id="music-toggle">ðŸ”Š</button>

  <div class="background-1">
    <div class="container">
      <h1 class="dynamic-title">
        <span>Fauzi</span>
        <span class="amp">&</span>
        <span>Liansky</span>
      </h1>
      <h3>Pernikahan - 27 Juli 2025</h3>
      <div class="countdown" id="countdown">Menghitung waktu...</div>
    </div>
  </div>

  <div class="background-2">
    <div class="container">
      <h2>Undangan</h2>
      <p>Dengan penuh kebahagiaan, kami mengundang...</p>
    </div>
  </div>

  <div class="background-3">
    <div class="container">
      <h2>RSVP</h2>
      <form id="rsvp-form">
        <input type="text" id="rsvp-nama" placeholder="Nama Anda" required>
        <select id="rsvp-hadir" required>
          <option value="">Konfirmasi Kehadiran</option>
          <option value="Hadir">Hadir</option>
          <option value="Tidak Hadir">Tidak Hadir</option>
        </select>
        <input type="number" id="rsvp-pax" placeholder="Jumlah orang (pax)" min="1">
        <button type="submit">Kirim RSVP</button>
      </form>
      <h2>Ucapan & Doa</h2>
      <form id="wish-form">
        <input type="text" id="wish-nama" placeholder="Nama Anda" required>
        <textarea id="wish-pesan" placeholder="Ucapan & Doa" required></textarea>
        <button type="submit">Kirim Ucapan</button>
      </form>
      <div id="wishes-display"></div>
      <div id="pagination"></div>
      <h2>Hadiah</h2>
      <a class="button" href="https://www.giftster.com/list/Z7Ogt/">Lihat Gift List</a>
    </div>
  </div>

  <script>
    const firebaseConfig = {
      apiKey: "AIzaSyD_XJTed1xlR885PImafVa5dRXlaDtkT4M",
      authDomain: "fauzi-cacha.firebaseapp.com",
      databaseURL: "https://fauzi-cacha-default-rtdb.asia-southeast1.firebasedatabase.app",
      projectId: "fauzi-cacha",
      storageBucket: "fauzi-cacha.appspot.com",
      messagingSenderId: "215870485063",
      appId: "1:215870485063:web:0af6f750fd09113e4ef762",
      measurementId: "G-8J1TKRWZV9"
    };

    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();

    // Countdown
    const countdown = document.getElementById("countdown");
    const targetDate = new Date("July 27, 2025 07:00:00 GMT+0700").getTime();
    setInterval(() => {
      const now = new Date().getTime();
      const distance = targetDate - now;
      if (distance < 0) {
        countdown.innerHTML = "Hari ini adalah hari pernikahan kami ðŸŽ‰";
        return;
      }
      const totalHours = Math.floor(distance / (1000 * 60 * 60));
      const weeks = Math.floor(totalHours / (24 * 7));
      const days = Math.floor((totalHours % (24 * 7)) / 24);
      const hours = totalHours % 24;
      countdown.innerHTML = `Menuju Akad: ${weeks} minggu ${days} hari ${hours} jam lagi`;
    }, 1000);

    // Music toggle
    const music = document.getElementById("bg-music");
    const musicToggle = document.getElementById("music-toggle");
    let isMuted = false;
    musicToggle.addEventListener("click", () => {
      if (isMuted) {
        music.play();
        musicToggle.innerText = "ðŸ”Š";
      } else {
        music.pause();
        musicToggle.innerText = "ðŸ”‡";
      }
      isMuted = !isMuted;
    });

    // RSVP Submit
    document.getElementById("rsvp-form").addEventListener("submit", function(e) {
      e.preventDefault();
      const nama = document.getElementById("rsvp-nama").value;
      const hadir = document.getElementById("rsvp-hadir").value;
      const pax = document.getElementById("rsvp-pax").value;
      db.ref('rsvp').push({ nama, hadir, pax });
      alert("Terima kasih sudah mengisi RSVP!");
      this.reset();
    });

    // Wishes Submit
    document.getElementById("wish-form").addEventListener("submit", function(e) {
      e.preventDefault();
      const nama = document.getElementById("wish-nama").value;
      const pesan = document.getElementById("wish-pesan").value;
      db.ref('wishes').push({ nama, pesan, timestamp: Date.now() });
      alert("Ucapan Anda telah terkirim!");
      this.reset();
    });

    // Pagination for Wishes
    const wishesDiv = document.getElementById("wishes-display");
    const paginationDiv = document.getElementById("pagination");
    let currentPage = 1;
    const itemsPerPage = 10;

    function loadWishes(page) {
      db.ref('wishes').orderByChild('timestamp').once('value', (snapshot) => {
        const data = [];
        snapshot.forEach(child => data.push(child.val()));
        data.reverse();

        const totalPages = Math.ceil(data.length / itemsPerPage);
        wishesDiv.innerHTML = "";
        paginationDiv.innerHTML = "";

        const start = (page - 1) * itemsPerPage;
        const end = start + itemsPerPage;
        data.slice(start, end).forEach(entry => {
          const div = document.createElement('div');
          div.className = 'entry';
          div.innerHTML = `<strong>${entry.nama}</strong><br>${entry.pesan}`;
          wishesDiv.appendChild(div);
        });

        for (let i = 1; i <= totalPages; i++) {
          const btn = document.createElement('button');
          btn.textContent = i;
          if (i === page) btn.style.fontWeight = 'bold';
          btn.onclick = () => { currentPage = i; loadWishes(i); };
          paginationDiv.appendChild(btn);
        }
      });
    }

    loadWishes(currentPage);
    setInterval(() => loadWishes(currentPage), 5000);
  </script>
</body>
</html>
